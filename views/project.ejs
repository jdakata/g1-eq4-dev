<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('head.ejs') %>
</head>
<body>

<%
function getCurrentSprint(sprints) {
    let today = new Date();
    for (let sprint of sprints) {
        if (new Date(sprint.start) <= today && today <= new Date(sprint.end))
            return sprint.start + " - " + sprint.end;
    }
    return "Aucun"
}
%>

<div class="container">

    <%- include('navigation.ejs') %>

    <div class="jumbotron">
        <h1 class="projName"><%= project.name %></h1>
        <p class="projDescription"><%= project.description %></p>
    </div>

    <p>Date de début : <%= moment(project.start).locale('fr').format('DD MMMM YYYY') %></p>
    <p>Date de fin : <%= moment(project.end).locale('fr').format('DD MMMM YYYY') %></p>

    <p>Sprint en cours : <%= getCurrentSprint(project.management.backlog.sprints) %></p>

    <p>Membres <a href="/projects/<%= project._id %>/new-member" class="btn btn-primary">Nouveau membre</a></p>
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <% project.members.forEach(function(member) { %>
                    <div class="col">
                        <span name="name"><p>Nom : <%= member.name %></p></span>
                        <span name="role"><p>Rôle : <%= member.role %></p></span>
                        <span name="email"><p>Email : <%= member.email %></p></span>
                        <span name="color"><p>Couleur : <i class="fa fa-square"
                                                           style="color: #<%= member.color %>"></i></p></span>
                        <form action="/projects/<%= project._id %>/members/<%= member._id %>" method="post">
                            <button type="submit" class="btn btn-success btn-danger">Supprimer le membre</button>
                        </form>
                    </div>
                <% }); %>
            </div>
        </div>
    </div>
</div>

<footer>
    <%- include('footer.ejs') %>
</footer>

</body>
</html>
